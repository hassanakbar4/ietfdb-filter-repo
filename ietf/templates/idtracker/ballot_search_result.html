{# Copyright The IETF Trust 2007, All Rights Reserved #}
{% extends "idtracker/base.html" %}
{% load ietf_filters %}

{% block title %}-- Ballot for {{ draft.document.filename }}{% endblock %}

{% block idcontent %}
<form action="/idtracker/position/" method="POST" name="form_post">
       <input type="hidden" name="loginid" value="{{LoginObj.id}}">
       <input type="hidden" name="telechat_date" value="{{request.GET.telechat_date}}">
       <input type="hidden" name="my_position" value="{{request.GET.my_position}}">

<a name="top"></a>
{% for l in list_ballot.items %}
       <h1>{{l.0}} for {{LoginObj}}</h1>
       <table border="1">
       <tr>
       <th>&nbsp;</th>
       <th width="110">Not Recorded</th>
                                                                                                                                                                                                                                        
       <th width="110">Yes</th>
       <th width="110">No Objection</th>
       <th width="110">Discuss</th>
       <th width="110">Abstain</th>
       <th width="110">Recuse</th>
       </tr>

       {% for k in l.1.items %}
       <tr bgcolor="#F8F8FF">
               <td colspan="7">
                       <b><font size= +1>{{k.0}}</font></b>
               </td>
       </tr>
               {% for position in k.1 %}
       <tr bgcolor="{% ifequal position.discuss 0 %}#FAFAD2{%endifequal %}">
               <td>
                       {% ifnotequal position.ballot.drafts.count 1 %}
                               <li>{{position.ballot.drafts.count}} documents ballot
                       {% endifnotequal %}
                       <a href="/idtracker/ballot/{{position.ballot.ballot}}/">[bal]</a>
                       <a href="/idtracker/{{position.ballot.get_primary_draft.get_absolute_url}}/">[detail]</a>

                       <br >
                       {% for id in position.ballot.drafts.all %}
                               <a href="#{{id.draft.filename}}"
                                       >{{ id.draft.filename }}-{{ id.draft.revision }}.txt</a>
                               <br >
                       {% endfor %}
               </td>
               <td>
                       <input type="radio" name="{{position.ballot.ballot}}"
                               value="not_recorded"
                               {% if not position.get_active_position %}
                                       checked
                               {% endif %}
                       >
                       {% if not position.get_active_position %}
                               <font color="red"><b>X</b></font>
                       {% endif %}
                       ({{position.ballot|count_position}})
               </td>
               <td>
                       <input type="radio" name="{{position.ballot.ballot}}"
                               value="yes_col"
                               {% ifequal position.get_active_position "yes_col" %}
                                       checked
                               {% endifequal %}
                       >
                       {% ifequal position.get_active_position "yes_col" %}
                               <font color="red"><b>X</b></font>
                       {% endifequal %}
                       ({{position.ballot|count_position}})
               </td>  
               <td>
                       <input type="radio" name="{{position.ballot.ballot}}"
                               value="no_col"
                               {% ifequal position.get_active_position "no_col" %}
                                       checked
                               {% endifequal %}
                       >
                       {% ifequal position.get_active_position "no_col" %}
                               <font color="red"><b>X</b></font>
                       {% endifequal %}
                       ({{position.ballot|count_position:"noobj"}})
               </td>  
               <td>
                       <input type="radio" name="{{position.ballot.ballot}}"
                               value="discuss"
                               {% ifequal position.get_active_position "discuss" %}
                                       checked
                               {% endifequal %}
                       >
                       {% ifequal position.get_active_position "discuss" %}
                               <font color="red"><b>X</b></font>
                       {% endifequal %}
                       ({{position.ballot|count_position:"discuss"}})
               </td>  
               <td>
                       <input type="radio" name="{{position.ballot.ballot}}"
                               value="abstain"
                               {% ifequal position.get_active_position "abstain" %}
                                       checked
                               {% endifequal %}
                       >
                       {% ifequal position.get_active_position "abstain" %}
                               <font color="red"><b>X</b></font>
                       {% endifequal %}
                       ({{position.ballot|count_position:"abstain"}})
               </td>  
               <td>
                       <input type="radio" name="{{position.ballot.ballot}}"
                               value="recuse"
                               {% ifequal position.get_active_position "recuse" %}
                                       checked
                               {% endifequal %}
                       >
                       {% ifequal position.get_active_position "recuse" %}
                               <font color="red"><b>X</b></font>
                       {% endifequal %}
                       ({{position.ballot|count_position:"recuse"}})
               </td>  
               {% endfor %}
       </tr>
       {% endfor %}
       </table>
{% endfor %}

{% if list_ballot %}
       <input type="submit" value=" Update All Positions ">
{% endif %}
</form>

<form action="/idtracker/" method="GET" name="form1">
       <input type="hidden" name="loginid" value="{{LoginObj.id}}">
   <input type="submit" value="Main Menu">
   <input type="button" name="back_button" value="BACK" onClick="history.go(-1);return true">

 </form>
<hr>

{% for position in positions %}
       {% if position.ballot.get_primary_draft %}

       <a name="{{position.ballot.get_primary_draft.draft.filename}}"></a>
       {% for i in position.ballot.drafts.all %}
       <h1>{{i.document.filename}}</a></h1>
       {% endfor %}

       <a href="/idtracker/ballot/{{position.ballot.ballot}}">[ballot]</a>
       <a href="/idtracker/{{position.ballot.get_primary_draft.get_absolute_url}}/">[I-D Detail]</a>
       <a href="#top">[return to top]</a>
       <h2>Ballot Writeup</h2>
       <pre>{{position.ballot.ballot_writeup}}</pre>
       <h2>Approval Text</h2>
       <pre>{{position.ballot.approval_text}}</pre>
       {% endif %}
{% endfor %}

{% endblock %}
